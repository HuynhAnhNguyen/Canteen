"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[166],{8166:(pe,A,a)=>{a.r(A),a.d(A,{AuthModule:()=>me});var m=a(9808),d=a(1891),v=a(5861),l=a(2340),e=a(7587),p=a(520),f=a(9783),y=a(845),b=a(1424),g=a(3075),_=a(7773),x=a(693);function U(r,i){1&r&&e._UZ(0,"app-loading")}function w(r,i){1&r&&(e.TgZ(0,"small",14),e._uU(1,"M\xe3 OTP l\xe0 b\u1eaft bu\u1ed9c"),e.qZA())}let O=(()=>{class r{constructor(t,n,o){this.httpClient=t,this.router=n,this.messageService=o,this.otpCode="",this.loading=!1,this.isSubmitted=!1}ngOnInit(){}activeAccount(){var t=this;return(0,v.Z)(function*(){t.isSubmitted=!0,t.otpCode?(t.loading=!0,yield t.httpClient.post(l.N.backendApiUrl+"/api/v1/project/auth/active?code="+t.otpCode,null).toPromise().then(n=>{"0"==n.resultCode?(t.messageService.add({severity:"success",summary:n.message}),setTimeout(()=>{t.router.navigate(["/auth/dang-nhap"])},2e3)):t.messageService.add({severity:"error",summary:n.message})},n=>{t.messageService.add({severity:"error",summary:"\u0110\xe3 x\u1ea3y ra l\u1ed7i"})}),t.loading=!1):t.messageService.add({severity:"error",summary:"Vui l\xf2ng nh\u1eadp m\xe3 OTP!"})})()}sendOTP(){var t=this;return(0,v.Z)(function*(){t.loading=!0,yield t.httpClient.post(l.N.backendApiUrl+"/api/v1/project/auth/send-otp",null).toPromise().then(n=>{t.messageService.add("0"==n.resultCode?{severity:"success",summary:"M\xe3 OTP \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi, vui l\xf2ng ki\u1ec3m tra email/SMS."}:{severity:"error",summary:n.message})}).catch(n=>{t.messageService.add({severity:"error",summary:"\u0110\xe3 x\u1ea3y ra l\u1ed7i khi g\u1eedi OTP."})}),t.loading=!1})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.eN),e.Y36(d.F0),e.Y36(f.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-active-account"]],decls:17,vars:3,consts:[[4,"ngIf"],[1,"surface-0","flex","align-items-center","justify-content-center","min-h-screen","min-w-screen","overflow-hidden"],[1,"grid","justify-content-center","p-2","lg:p-0",2,"min-width","80%"],[1,"col-12","xl:col-6",2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"h-full","w-full","m-0","py-7","px-4",2,"border-radius","53px","background","linear-gradient(180deg, var(--surface-50) 38.9%, var(--surface-0))"],[1,"text-center","mb-5"],["src","assets/layout/images/logo.svg","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"w-full","md:w-10","mx-auto"],["for","otpCode",1,"block","text-900","text-xl","font-medium","mb-2"],["id","otpCode","type","text","placeholder","Nh\u1eadp m\xe3 OTP","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["style","color: red;",4,"ngIf"],["pButton","","pRipple","","label","G\u1eedi l\u1ea1i m\xe3 OTP",1,"w-full","p-3","mt-3","text-xl","bg-blue-500","text-white",3,"click"],["pButton","","pRipple","","label","K\xedch ho\u1ea1t t\xe0i kho\u1ea3n",1,"w-full","p-3","mt-5","text-xl","bg-green-500","text-white",3,"click"],[2,"color","red"]],template:function(t,n){1&t&&(e._UZ(0,"p-toast"),e.YNc(1,U,1,0,"app-loading",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"div",7),e._uU(9,"Nh\u1eadp m\xe3 x\xe1c nh\u1eadn c\u1ee7a b\u1ea1n"),e.qZA()(),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"Nh\u1eadp m\xe3 OTP"),e.qZA(),e.TgZ(13,"input",10),e.NdJ("ngModelChange",function(s){return n.otpCode=s}),e.qZA(),e.YNc(14,w,2,0,"small",11),e.TgZ(15,"button",12),e.NdJ("click",function(){return n.sendOTP()}),e.qZA(),e.TgZ(16,"button",13),e.NdJ("click",function(){return n.activeAccount()}),e.qZA()()()()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(12),e.Q6J("ngModel",n.otpCode),e.xp6(1),e.Q6J("ngIf",!n.otpCode&&n.isSubmitted))},dependencies:[m.O5,y.Hq,b.o,g.Fj,g.JJ,g.On,_.FN,x.N],styles:["[_nghost-%COMP%]     .p-password input{width:100%;padding:1rem}[_nghost-%COMP%]     .pi-eye{transform:scale(1.6);margin-right:1rem;color:var(--primary-color)!important}[_nghost-%COMP%]     .pi-eye-slash{transform:scale(1.6);margin-right:1rem;color:var(--primary-color)!important}*[_ngcontent-%COMP%]{box-sizing:border-box}"]}),r})();function M(r,i){1&r&&e._UZ(0,"app-loading")}function I(r,i){1&r&&(e.TgZ(0,"small",17),e._uU(1,"Username l\xe0 b\u1eaft bu\u1ed9c"),e.qZA())}const N=function(){return["/auth/dang-ky"]};let q=(()=>{class r{constructor(t,n,o){this.httpClient=t,this.router=n,this.messageService=o,this.loading=!1}ngOnInit(){}forgotPassword(){var t=this;return(0,v.Z)(function*(){t.loading=!0,yield t.httpClient.post(l.N.backendApiUrl+"/api/v1/project/auth/forgotpw",{userName:t.email}).toPromise().then(n=>{"0"==n.resultCode?(t.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"Vui l\xf2ng ki\u1ec3m tra email c\u1ee7a b\u1ea1n."}),setTimeout(()=>{t.router.navigate(["/auth/khoi-phuc-mat-khau"])},3e3)):t.messageService.add({severity:"error",summary:n.message})},n=>{t.messageService.add({severity:"error",summary:n.title})}),t.loading=!1})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.eN),e.Y36(d.F0),e.Y36(f.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-forgot-password"]],decls:22,vars:6,consts:[[4,"ngIf"],[1,"surface-0","flex","align-items-center","justify-content-center","min-h-screen","min-w-screen","overflow-hidden"],[1,"grid","justify-content-center","p-2","lg:p-0",2,"min-width","80%"],[1,"col-12","xl:col-6",2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"h-full","w-full","m-0","py-7","px-4",2,"border-radius","53px","background","linear-gradient(180deg, var(--surface-50) 38.9%, var(--surface-0))"],[1,"text-center","mb-5"],["src","assets/layout/images/logo.svg","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"text-600","font-medium","mb-3"],[1,"w-full","md:w-10","mx-auto"],["for","email1",1,"block","text-900","text-xl","font-medium","mb-2"],["id","email1","type","text","placeholder","Enter your username","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["class","ng-dirty ng-invalid","style","color: red;",4,"ngIf"],[1,"flex","align-items-center","justify-content-between","mb-5"],[1,"flex","align-items-center"],["routerLinkActive","router-link-active",1,"font-medium","no-underline","ml-2","text-right","cursor-pointer",2,"color","var(--primary-color)",3,"routerLink"],["pButton","","pRipple","","label","Kh\xf4i ph\u1ee5c",1,"w-full","p-3","text-xl",3,"disabled","click"],[1,"ng-dirty","ng-invalid",2,"color","red"]],template:function(t,n){1&t&&(e._UZ(0,"p-toast"),e.YNc(1,M,1,0,"app-loading",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"div",7),e._uU(9,"Qu\xean m\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(10,"span",8),e._uU(11,"Nh\u1eadp \u0111\u1ecba ch\u1ec9 email \u0111\u1ec3 kh\xf4i ph\u1ee5c m\u1eadt kh\u1ea9u"),e.qZA()(),e.TgZ(12,"div",9)(13,"label",10),e._uU(14,"Username"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("ngModelChange",function(s){return n.email=s}),e.qZA(),e.YNc(16,I,2,0,"small",12),e.TgZ(17,"div",13),e._UZ(18,"div",14),e.TgZ(19,"a",15),e._uU(20,"B\u1ea1n ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd ngay"),e.qZA()(),e.TgZ(21,"button",16),e.NdJ("click",function(){return n.forgotPassword()}),e.qZA()()()()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(14),e.Q6J("ngModel",n.email),e.xp6(1),e.Q6J("ngIf",!n.email),e.xp6(3),e.Q6J("routerLink",e.DdM(5,N)),e.xp6(2),e.Q6J("disabled",!n.email))},dependencies:[m.O5,d.yS,d.Od,y.Hq,b.o,g.Fj,g.JJ,g.On,_.FN,x.N],encapsulation:2}),r})();function P(r,i){1&r&&e._UZ(0,"app-loading")}function S(r,i){1&r&&(e.TgZ(0,"small",20),e._uU(1,"OTP l\xe0 b\u1eaft bu\u1ed9c"),e.qZA())}function D(r,i){1&r&&(e.TgZ(0,"small",20),e._uU(1,"M\u1eadt kh\u1ea9u l\xe0 b\u1eaft bu\u1ed9c."),e.qZA())}function J(r,i){1&r&&(e.TgZ(0,"small",20),e._uU(1,"M\u1eadt kh\u1ea9u kh\xf4ng kh\u1edbp."),e.qZA())}const F=function(){return["/auth/dang-ky"]};let Q=(()=>{class r{constructor(t,n,o){this.httpClient=t,this.router=n,this.messageService=o,this.loading=!1}ngOnInit(){}resetPassword(){var t=this;return(0,v.Z)(function*(){t.loading=!0,t.newPassword===t.confirmPassword?(yield t.httpClient.post(l.N.backendApiUrl+"/api/v1/project/auth/resetpw",{token:t.code,password:t.newPassword}).toPromise().then(n=>{"0"==n.resultCode?(t.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 \u0111\u1eb7t l\u1ea1i m\u1eadt kh\u1ea9u th\xe0nh c\xf4ng. \u0110\u0103ng nh\u1eadp ngay!"}),setTimeout(()=>{t.router.navigate(["/auth/dang-nhap"])},2e3)):t.messageService.add({severity:"error",summary:n.message})},n=>{console.log(n),t.messageService.add({severity:"error",summary:n.error.title})}),t.loading=!1):t.messageService.add({severity:"warning",summary:"Th\xf4ng b\xe1o",detail:"M\u1eadt kh\u1ea9u x\xe1c nh\u1eadn kh\xf4ng kh\u1edbp!"})})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.eN),e.Y36(d.F0),e.Y36(f.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-reset-password"]],decls:29,vars:10,consts:[[4,"ngIf"],[1,"surface-0","flex","align-items-center","justify-content-center","min-h-screen","min-w-screen","overflow-hidden"],[1,"grid","justify-content-center","p-2","lg:p-0",2,"min-width","80%"],[1,"col-12","xl:col-6",2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"h-full","w-full","m-0","py-7","px-4",2,"border-radius","53px","background","linear-gradient(180deg, var(--surface-50) 38.9%, var(--surface-0))"],[1,"text-center","mb-5"],["src","assets/layout/images/logo.svg","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"w-full","md:w-10","mx-auto"],["for","OTP",1,"block","text-900","text-xl","font-medium","mb-2"],["id","OTP","type","text","placeholder","Nh\u1eadp m\xe3 OTP \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn email c\u1ee7a b\u1ea1n","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["class","ng-dirty ng-invalid","style","color: red;",4,"ngIf"],["for","newPassword",1,"block","text-900","text-xl","font-medium","mb-2"],["id","newPassword","type","password","placeholder","Nh\u1eadp m\u1eadt kh\u1ea9u m\u1edbi","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["for","confirmPassword",1,"block","text-900","text-xl","font-medium","mb-2","mt-3"],["id","confirmPassword","type","password","placeholder","Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],[1,"flex","align-items-center","justify-content-between","mb-5"],[1,"flex","align-items-center"],["routerLinkActive","router-link-active",1,"font-medium","no-underline","ml-2","text-right","cursor-pointer",2,"color","var(--primary-color)",3,"routerLink"],["pButton","","pRipple","","label","\u0110\u1eb7t l\u1ea1i m\u1eadt kh\u1ea9u",1,"w-full","p-3","text-xl",3,"disabled","click"],[1,"ng-dirty","ng-invalid",2,"color","red"]],template:function(t,n){1&t&&(e._UZ(0,"p-toast"),e.YNc(1,P,1,0,"app-loading",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"div",7),e._uU(9,"\u0110\u1eb7t l\u1ea1i m\u1eadt kh\u1ea9u c\u1ee7a b\u1ea1n"),e.qZA()(),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"M\xe3 OTP"),e.qZA(),e.TgZ(13,"input",10),e.NdJ("ngModelChange",function(s){return n.code=s}),e.qZA(),e.YNc(14,S,2,0,"small",11),e.qZA(),e.TgZ(15,"div",8)(16,"label",12),e._uU(17,"M\u1eadt kh\u1ea9u m\u1edbi"),e.qZA(),e.TgZ(18,"input",13),e.NdJ("ngModelChange",function(s){return n.newPassword=s}),e.qZA(),e.YNc(19,D,2,0,"small",11),e.TgZ(20,"label",14),e._uU(21,"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(22,"input",15),e.NdJ("ngModelChange",function(s){return n.confirmPassword=s}),e.qZA(),e.YNc(23,J,2,0,"small",11),e.TgZ(24,"div",16),e._UZ(25,"div",17),e.TgZ(26,"a",18),e._uU(27,"B\u1ea1n ch\u01b0a c\xf3 t\xe0i kho\u1ea3n?"),e.qZA()(),e.TgZ(28,"button",19),e.NdJ("click",function(){return n.resetPassword()}),e.qZA()()()()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(12),e.Q6J("ngModel",n.code),e.xp6(1),e.Q6J("ngIf",!n.code),e.xp6(4),e.Q6J("ngModel",n.newPassword),e.xp6(1),e.Q6J("ngIf",!n.newPassword),e.xp6(3),e.Q6J("ngModel",n.confirmPassword),e.xp6(1),e.Q6J("ngIf",n.confirmPassword&&n.newPassword!==n.confirmPassword),e.xp6(3),e.Q6J("routerLink",e.DdM(9,F)),e.xp6(2),e.Q6J("disabled",!n.code||!n.newPassword))},dependencies:[m.O5,d.yS,d.Od,y.Hq,b.o,g.Fj,g.JJ,g.On,_.FN,x.N],encapsulation:2}),r})();var j=a(9394),C=a(8356);function L(r,i){1&r&&e._UZ(0,"app-loading")}const H=function(){return["/auth/dang-nhap"]};let Y=(()=>{class r{constructor(t,n,o){this.messageService=t,this.router=n,this.httpClient=o,this.userName="",this.passWord="",this.confirmPassWord="",this.email="",this.phoneNumber="",this.fullname="",this.loading=!1}ngOnInit(){}signup(){var t=this;return(0,v.Z)(function*(){if(t.isPasswordMatch()){t.loading=!0;try{const n=yield t.httpClient.post(l.N.backendApiUrl+"/api/v1/project/auth/signup",{userName:t.userName,passWord:t.passWord,email:t.email,phoneNumber:t.phoneNumber,fullname:t.fullname}).toPromise();console.log("API Response:",n),"0"==n.resultCode?(console.log("signUpResponse.resultCode "+n.resultCode),t.messageService.add({severity:"success",summary:"\u0110\u0103ng k\xfd t\xe0i kho\u1ea3n th\xe0nh c\xf4ng"}),setTimeout(()=>{console.log("Chuy\u1ec3n h\u01b0\u1edbng..."),t.router.navigate(["/auth/kich-hoat-tai-khoan"]).then(o=>{console.log(o?"Chuy\u1ec3n h\u01b0\u1edbng th\xe0nh c\xf4ng!":"Chuy\u1ec3n h\u01b0\u1edbng th\u1ea5t b\u1ea1i!")})},2e3)):(console.log("signUpResponse.resultCode "+n.resultCode),t.messageService.add({severity:"error",summary:n.message}))}catch(n){t.messageService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i!"}),t.router.navigate([j.R.common.error])}finally{t.loading=!1}t.loading=!1}else t.messageService.add({severity:"error",summary:"M\u1eadt kh\u1ea9u x\xe1c nh\u1eadn kh\xf4ng kh\u1edbp!"})})()}isPasswordMatch(){return this.passWord===this.confirmPassWord}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(f.ez),e.Y36(d.F0),e.Y36(p.eN))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-sign-up"]],decls:34,vars:12,consts:[[4,"ngIf"],[1,"surface-0","flex","align-items-center","justify-content-center","min-h-screen","min-w-screen","overflow-hidden"],[1,"grid","justify-content-center","p-2","lg:p-0",2,"min-width","80%"],[1,"col-12","xl:col-6",2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"h-full","w-full","m-0","py-7","px-4",2,"border-radius","53px","background","linear-gradient(180deg, var(--surface-50) 38.9%, var(--surface-0))"],[1,"text-center","mb-5"],["src","assets/layout/images/logo.svg","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"w-full","md:w-10","mx-auto"],["for","fullname",1,"block","text-900","text-xl","font-medium","mb-2"],["id","fullname","type","text","placeholder","H\u1ecd v\xe0 t\xean","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["for","userName",1,"block","text-900","text-xl","font-medium","mb-2"],["id","userName","type","text","placeholder","Username","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["for","email",1,"block","text-900","text-xl","font-medium","mb-2"],["id","email","type","text","placeholder","abcd@gmail.com","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["for","phoneNumber",1,"block","text-900","text-xl","font-medium","mb-2"],["id","phoneNumber","type","text","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i","pInputText","",1,"w-full","mb-3",2,"padding","1rem",3,"ngModel","ngModelChange"],["for","passWord",1,"block","text-900","font-medium","text-xl","mb-2"],["id","passWord","placeholder","M\u1eadt kh\u1ea9u","styleClass","w-full mb-3",3,"ngModel","toggleMask","ngModelChange"],["for","confirmPassWord",1,"block","text-900","font-medium","text-xl","mb-2"],["id","confirmPassWord","placeholder","X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u","styleClass","w-full mb-3",3,"ngModel","toggleMask","ngModelChange"],[1,"flex","align-items-center","justify-content-between","mb-5"],[1,"flex","align-items-center"],["routerLinkActive","router-link-active",1,"font-medium","no-underline","ml-2","text-right","cursor-pointer",2,"color","var(--primary-color)",3,"routerLink"],["pButton","","pRipple","","label","\u0110\u0103ng k\xfd",1,"w-full","p-3","text-xl",3,"disabled","click"]],template:function(t,n){1&t&&(e._UZ(0,"p-toast"),e.YNc(1,L,1,0,"app-loading",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"div",7),e._uU(9,"\u0110\u0103ng k\xfd m\u1edbi t\xe0i kho\u1ea3n"),e.qZA()(),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"H\u1ecd v\xe0 t\xean"),e.qZA(),e.TgZ(13,"input",10),e.NdJ("ngModelChange",function(s){return n.fullname=s}),e.qZA(),e.TgZ(14,"label",11),e._uU(15,"Username"),e.qZA(),e.TgZ(16,"input",12),e.NdJ("ngModelChange",function(s){return n.userName=s}),e.qZA(),e.TgZ(17,"label",13),e._uU(18,"Email"),e.qZA(),e.TgZ(19,"input",14),e.NdJ("ngModelChange",function(s){return n.email=s}),e.qZA(),e.TgZ(20,"label",15),e._uU(21,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),e.qZA(),e.TgZ(22,"input",16),e.NdJ("ngModelChange",function(s){return n.phoneNumber=s}),e.qZA(),e.TgZ(23,"label",17),e._uU(24,"M\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(25,"p-password",18),e.NdJ("ngModelChange",function(s){return n.passWord=s}),e.qZA(),e.TgZ(26,"label",19),e._uU(27,"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(28,"p-password",20),e.NdJ("ngModelChange",function(s){return n.confirmPassWord=s}),e.qZA(),e.TgZ(29,"div",21)(30,"div",22)(31,"a",23),e._uU(32,"\u0110\xe3 c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng nh\u1eadp ngay."),e.qZA()()(),e.TgZ(33,"button",24),e.NdJ("click",function(){return n.signup()}),e.qZA()()()()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(12),e.Q6J("ngModel",n.fullname),e.xp6(3),e.Q6J("ngModel",n.userName),e.xp6(3),e.Q6J("ngModel",n.email),e.xp6(3),e.Q6J("ngModel",n.phoneNumber),e.xp6(3),e.Q6J("ngModel",n.passWord)("toggleMask",!0),e.xp6(3),e.Q6J("ngModel",n.confirmPassWord)("toggleMask",!0),e.xp6(3),e.Q6J("routerLink",e.DdM(11,H)),e.xp6(2),e.Q6J("disabled",!(n.fullname&&n.userName&&n.email&&n.phoneNumber&&n.passWord&&n.confirmPassWord)))},dependencies:[m.O5,d.yS,d.Od,y.Hq,b.o,g.Fj,g.JJ,g.On,C.ro,_.FN,x.N],styles:["[_nghost-%COMP%]     .p-password input{width:100%;padding:1rem}[_nghost-%COMP%]     .pi-eye{transform:scale(1.6);margin-right:1rem;color:var(--primary-color)!important}[_nghost-%COMP%]     .pi-eye-slash{transform:scale(1.6);margin-right:1rem;color:var(--primary-color)!important}"]}),r})();var E=a(2132),Z=a(4990),T=a(8874);function B(r,i){if(1&r&&(e.TgZ(0,"div")(1,"p")(2,"strong"),e._uU(3,"T\xean kh\xe1ch h\xe0ng: "),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"p")(6,"strong"),e._uU(7,"Email: "),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"p")(10,"strong"),e._uU(11,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i: "),e.qZA(),e._uU(12),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.hij(" ",t.userInfo.fullname,""),e.xp6(4),e.hij(" ",t.userInfo.email,""),e.xp6(4),e.hij(" ",t.userInfo.phonenumber,"")}}function R(r,i){1&r&&(e.TgZ(0,"div",6),e._uU(1," Gi\u1ecf h\xe0ng c\u1ee7a b\u1ea1n \u0111ang tr\u1ed1ng. "),e.TgZ(2,"div",7)(3,"button",8),e._uU(4,"Quay v\u1ec1 trang ch\u1ee7"),e.qZA()()())}function K(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td",17),e._uU(2),e.qZA(),e.TgZ(3,"td",11),e._uU(4),e.qZA(),e.TgZ(5,"td",17)(6,"button",18),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.decreaseQuantity(s.id))}),e._uU(7,"-"),e.qZA(),e.TgZ(8,"span",19),e._uU(9),e.qZA(),e.TgZ(10,"button",20),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.increaseQuantity(s.id))}),e._uU(11,"+"),e.qZA()(),e.TgZ(12,"td",17),e._uU(13),e.ALo(14,"number"),e.qZA(),e.TgZ(15,"td",17),e._uU(16),e.ALo(17,"number"),e.qZA(),e.TgZ(18,"td",17)(19,"button",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.deleteCartItem(s.id))}),e._uU(20,"X\xf3a"),e.qZA()()()}if(2&r){const t=i.$implicit,n=i.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.name),e.xp6(5),e.Oqu(t.quantity),e.xp6(4),e.hij("",e.xi3(14,5,t.price,"1.0-2")," VND"),e.xp6(3),e.hij("",e.xi3(17,8,t.quantity*t.price,"1.0-2")," VND")}}function W(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"table",9)(2,"thead")(3,"tr",10)(4,"th",11),e._uU(5,"STT"),e.qZA(),e.TgZ(6,"th",11),e._uU(7,"T\xean s\u1ea3n ph\u1ea9m"),e.qZA(),e.TgZ(8,"th",11),e._uU(9,"S\u1ed1 l\u01b0\u1ee3ng"),e.qZA(),e.TgZ(10,"th",11),e._uU(11,"\u0110\u01a1n gi\xe1"),e.qZA(),e.TgZ(12,"th",11),e._uU(13,"T\u1ed5ng ti\u1ec1n"),e.qZA(),e.TgZ(14,"th",11),e._uU(15,"H\xe0nh \u0111\u1ed9ng"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,K,21,11,"tr",12),e.qZA()(),e.TgZ(18,"div",13)(19,"h3",14),e._uU(20),e.ALo(21,"number"),e.qZA()(),e.TgZ(22,"div",15)(23,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.placeOrder())}),e._uU(24,"\u0110\u1eb7t h\xe0ng"),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(17),e.Q6J("ngForOf",t.cartItems),e.xp6(3),e.hij("T\u1ed5ng ti\u1ec1n: ",e.xi3(21,2,t.totalAmount,"1.0-2")," VND")}}let z=(()=>{class r{constructor(t,n,o){this.http=t,this.authService=n,this.messageService=o,this.cartItems=[],this.totalAmount=0,this.userInfo=null,this.stompClient=new Z.K({brokerURL:l.N.backendApiUrl+"/ws?token="+this.authService.getToken(),debug:s=>console.log(s),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3}),this.stompClient.onConnect=s=>{console.log("Connected: "+s);const u=c=>{let h;try{h=JSON.parse(c.body)}catch(he){h=c.body}switch(console.log("\u2705 N\u1ed9i dung th\xf4ng b\xe1o:",h),console.log(c),h){case"preparingOrder":this.messageService.add({severity:"success",summary:"\u0110\xe3 x\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng, \u0111\u01a1n h\xe0ng c\u1ee7a b\u1ea1n \u0111ang \u0111\u01b0\u1ee3c chu\u1ea9n b\u1ecb"});break;case"doneOrder":this.messageService.add({severity:"success",summary:"\u0110\u01a1n h\xe0ng \u0111\xe3 ho\xe0n th\xe0nh"});break;case"cancelOrder":this.messageService.add({severity:"warn",summary:"\u0110\u01a1n h\xe0ng \u0111\xe3 h\u1ee7y"});break;case"rejectOrder":this.messageService.add({severity:"warn",summary:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y do b\u1ea1n kh\xf4ng \u0111\u1ebfn nh\u1eadn h\xe0ng"});break;default:console.log(c)}this.loadCart()};this.stompClient.subscribe("/user/queue/notifications",u),this.stompClient.subscribe("/topic/public",u)},this.stompClient.onDisconnect=()=>{console.log("Disconnected!")},this.connect()}ngOnInit(){this.header=(new p.WM).set(E.ds.AUTHORIZATION,this.authService.getToken()),this.getUserInfo(),this.loadCart()}ngOnDestroy(){this.disconnect()}connect(){this.stompClient.activate()}disconnect(){this.stompClient.deactivate()}loadCart(){this.cartId=this.authService.getCartid(),this.http.get(l.N.backendApiUrl+"/api/v1/project/cartItem/info?cartId="+this.cartId,{headers:this.header}).subscribe(t=>{0===t.resultCode?t.data&&t.data.length>0?(this.cartItems=t.data.map(n=>({id:n.id,name:n.foodName,quantity:n.quantity,price:n.foodPrice,foodId:n.foodId})),this.calculateTotalAmount()):(this.cartItems=[],this.calculateTotalAmount(),this.messageService.add({severity:"info",summary:"Th\xf4ng b\xe1o",detail:"Gi\u1ecf h\xe0ng c\u1ee7a b\u1ea1n \u0111ang tr\u1ed1ng"})):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:t.message})},t=>{console.error("L\u1ed7i khi t\u1ea3i gi\u1ecf h\xe0ng:",t),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 t\u1ea3i gi\u1ecf h\xe0ng"})})}getUserInfo(){this.userInfo={fullname:this.authService.getFullname(),email:this.authService.getEmail(),phonenumber:this.authService.getPhonenumber()}}increaseQuantity(t){this.updateQuantity(t,1),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"T\u0103ng s\u1ed1 l\u01b0\u1ee3ng th\xe0nh c\xf4ng"})}decreaseQuantity(t){const n=this.cartItems.find(o=>o.id===t);n&&n.quantity>1?(this.updateQuantity(t,-1),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"Gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng th\xe0nh c\xf4ng"})):this.deleteCartItem(t)}updateQuantity(t,n){const o=this.cartItems.find(c=>c.id===t);if(!o)return;const s=o.quantity+n;s<1?this.deleteCartItem(t):this.http.put(l.N.backendApiUrl+"/api/v1/project/cartItem/update",{cartItemId:t,quantity:s},{headers:this.header}).subscribe(c=>{0===c.resultCode?(o.quantity=s,o.totalPrice=o.quantity*o.price,this.cartItems=[...this.cartItems],this.calculateTotalAmount(),this.loadCart(),console.log(this.cartItems)):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:c.message})},c=>{console.error("L\u1ed7i khi c\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng:",c),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng"})})}deleteCartItem(t){this.http.delete(l.N.backendApiUrl+`/api/v1/project/cartItem/delete?cartItemId=${t}`,{headers:this.header}).subscribe(n=>{0===n.resultCode?(this.cartItems=this.cartItems.filter(o=>o.id!==t),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"X\xf3a m\xf3n \u0103n th\xe0nh c\xf4ng"}),this.calculateTotalAmount(),this.loadCart(),console.log(this.cartItems)):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:n.message})},n=>{console.error("L\u1ed7i khi x\xf3a s\u1ea3n ph\u1ea9m:",n),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 x\xf3a s\u1ea3n ph\u1ea9m"})})}calculateTotalAmount(){this.totalAmount=this.cartItems.reduce((t,n)=>t+n.price*n.quantity,0)}placeOrder(){const t=this.authService.getAccountid(),n=this.authService.getCartid();if(console.log("Account ID:",t),console.log("Cart ID:",n),!t||!n)return console.error("L\u1ed7i: Account ID ho\u1eb7c Cart ID kh\xf4ng h\u1ee3p l\u1ec7!"),void this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 \u0111\u1eb7t h\xe0ng do thi\u1ebfu th\xf4ng tin"});this.http.post(l.N.backendApiUrl+"/api/v1/project/order/create",{account_id:t,cart_id:n},{headers:this.header}).subscribe(s=>{console.log("API Response:",s),0===s.resultCode?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\u1eb7t h\xe0ng th\xe0nh c\xf4ng!"}),this.cartItems=[]):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:s.message})},s=>{console.error("L\u1ed7i khi \u0111\u1eb7t h\xe0ng:",s),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 \u0111\u1eb7t h\xe0ng"})})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.eN),e.Y36(T.e),e.Y36(f.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-cart"]],features:[e._Bn([f.ez])],decls:13,vars:4,consts:[[1,"p-4"],["routerLink","/",1,"px-4","py-2","bg-blue-500","text-white","rounded",2,"margin-right","10px"],["routerLink","/auth/lich-su",1,"px-4","py-2","bg-blue-500","text-white","rounded"],[1,"text-center","text-xl","font-bold","mb-4"],[4,"ngIf"],["class","text-center text-gray-500 text-lg",4,"ngIf"],[1,"text-center","text-gray-500","text-lg"],[1,"mt-4"],["routerLink","/",1,"px-4","py-2","bg-blue-500","text-white","rounded"],[1,"w-full","border-collapse","border","border-gray-300"],[1,"bg-gray-200"],[1,"border","border-gray-300","px-4","py-2"],[4,"ngFor","ngForOf"],[1,"mt-4","flex","justify-between","items-center"],[1,"text-lg","font-bold"],[1,"grid","mt-4","justify-between","items-center",2,"top","50%","left","50%"],[1,"px-4","py-2","bg-blue-500","text-white","rounded",3,"click"],[1,"border","border-gray-300","px-4","py-2","text-center"],[1,"px-2","py-1","bg-red-500","text-white","rounded",3,"click"],[1,"mx-2"],[1,"px-2","py-1","bg-green-500","text-white","rounded",3,"click"],[1,"px-3","py-1","bg-red-600","text-white","rounded",3,"click"]],template:function(t,n){1&t&&(e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"button",1),e._uU(3,"Quay v\u1ec1 trang ch\u1ee7"),e.qZA(),e.TgZ(4,"button",2),e._uU(5,"L\u1ecbch s\u1eed mua h\xe0ng"),e.qZA(),e.TgZ(6,"h2",3),e._uU(7,"Gi\u1ecf H\xe0ng C\u1ee7a "),e.TgZ(8,"strong"),e._uU(9),e.qZA()(),e.YNc(10,B,13,3,"div",4),e.YNc(11,R,5,0,"div",5),e.YNc(12,W,25,5,"div",4),e.qZA()),2&t&&(e.xp6(9),e.hij(" ",n.userInfo.fullname," "),e.xp6(1),e.Q6J("ngIf",n.userInfo),e.xp6(1),e.Q6J("ngIf",0===n.cartItems.length),e.xp6(1),e.Q6J("ngIf",n.cartItems.length>0))},dependencies:[m.sg,m.O5,d.rH,_.FN,m.JJ],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:center}th[_ngcontent-%COMP%]{background-color:#f4f4f4}button[_ngcontent-%COMP%]{cursor:pointer}"]}),r})();var k=a(9142);function G(r,i){if(1&r&&(e.TgZ(0,"div")(1,"p")(2,"strong"),e._uU(3,"T\xean kh\xe1ch h\xe0ng: "),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"p")(6,"strong"),e._uU(7,"Email: "),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"p")(10,"strong"),e._uU(11,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i: "),e.qZA(),e._uU(12),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.hij(" ",t.userInfo.fullname,""),e.xp6(4),e.hij(" ",t.userInfo.email,""),e.xp6(4),e.hij(" ",t.userInfo.phonenumber,"")}}function X(r,i){1&r&&e._UZ(0,"p-tag",16)}function V(r,i){1&r&&e._UZ(0,"p-tag",17)}function $(r,i){1&r&&e._UZ(0,"p-tag",18)}function ee(r,i){1&r&&e._UZ(0,"p-tag",19)}function te(r,i){1&r&&e._UZ(0,"p-tag",20)}function ne(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"number"),e.qZA(),e.TgZ(9,"td"),e.YNc(10,X,1,0,"p-tag",9),e.YNc(11,V,1,0,"p-tag",10),e.YNc(12,$,1,0,"p-tag",11),e.YNc(13,ee,1,0,"p-tag",12),e.YNc(14,te,1,0,"p-tag",13),e.qZA(),e.TgZ(15,"td")(16,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.cancelOrder(s.id))}),e._uU(17," H\u1ee7y \u0111\u01a1n h\xe0ng "),e.qZA()(),e.TgZ(18,"td")(19,"button",15),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.viewOrderDetails(s.id))}),e._uU(20,"Xem Chi Ti\u1ebft"),e.qZA()()()}if(2&r){const t=i.$implicit,n=i.index,o=e.oxw(2);e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(e.xi3(5,9,t.orderTime,"HH:mm:ss dd/MM/yyyy ")),e.xp6(3),e.hij("",e.xi3(8,12,t.totalPrice,"1.0-2")," VND"),e.xp6(3),e.Q6J("ngIf","unconfirmed"==t.status),e.xp6(1),e.Q6J("ngIf","preparing"==t.status),e.xp6(1),e.Q6J("ngIf","cancel"==t.status),e.xp6(1),e.Q6J("ngIf","done"==t.status),e.xp6(1),e.Q6J("ngIf","rejected"==t.status),e.xp6(2),e.Q6J("disabled",!o.canCancelOrder(t.status))}}function re(r,i){if(1&r&&(e.TgZ(0,"table")(1,"thead")(2,"tr")(3,"th"),e._uU(4,"STT"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Ng\xe0y \u0111\u1eb7t h\xe0ng"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"T\u1ed5ng ti\u1ec1n"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Chi ti\u1ebft"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,ne,21,15,"tr",8),e.qZA()()),2&r){const t=e.oxw();e.xp6(16),e.Q6J("ngForOf",t.orders)}}function oe(r,i){1&r&&(e.TgZ(0,"p",21),e._uU(1,"Kh\xf4ng c\xf3 \u0111\u01a1n h\xe0ng n\xe0o."),e.qZA())}function ie(r,i){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",26),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"number"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA()()),2&r){const t=i.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("src",n.backendApiUrl+"/api/v1/project/auth/"+t.imageUrl,e.LSH),e.xp6(2),e.Oqu(t.foodName),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij("",e.xi3(9,6,t.price,"1.0-2")," VND"),e.xp6(3),e.hij("",e.xi3(12,9,t.totalPrice,"1.0-2")," VND"),e.xp6(3),e.Oqu(t.description)}}function se(r,i){if(1&r&&(e.TgZ(0,"table")(1,"thead")(2,"tr")(3,"th"),e._uU(4,"H\xecnh \u1ea3nh"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"T\xean m\xf3n"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"S\u1ed1 l\u01b0\u1ee3ng"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Gi\xe1"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Th\xe0nh ti\u1ec1n"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"M\xf4 t\u1ea3"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,ie,15,12,"tr",8),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(16),e.Q6J("ngForOf",t.selectedOrderDetails)}}function ae(r,i){1&r&&(e.TgZ(0,"p",21),e._uU(1,"Kh\xf4ng c\xf3 th\xf4ng tin \u0111\u01a1n h\xe0ng."),e.qZA())}function ue(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",23)(2,"h2"),e._uU(3,"Chi Ti\u1ebft \u0110\u01a1n H\xe0ng"),e.qZA(),e.YNc(4,se,17,1,"table",5),e.YNc(5,ae,2,0,"ng-template",null,24,e.W1O),e.TgZ(7,"button",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeDetail())}),e._uU(8,"\u0110\xf3ng"),e.qZA()()()}if(2&r){const t=e.MAs(6),n=e.oxw();e.xp6(4),e.Q6J("ngIf",n.selectedOrderDetails.length>0)("ngIfElse",t)}}let le=(()=>{class r{constructor(t,n,o){this.http=t,this.authService=n,this.messageService=o,this.orders=[],this.selectedOrderDetails=[],this.showDetailModal=!1,this.userInfo=null,this.backendApiUrl="",this.backendApiUrl=l.N.backendApiUrl,this.stompClient=new Z.K({brokerURL:l.N.backendApiUrl+"/ws?token="+this.authService.getToken(),debug:s=>console.log(s),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3}),this.stompClient.onConnect=s=>{console.log("Connected: "+s);const u=c=>{let h;try{h=JSON.parse(c.body)}catch(he){h=c.body}switch(console.log("\u2705 N\u1ed9i dung th\xf4ng b\xe1o:",h),console.log(c),h){case"preparingOrder":this.messageService.add({severity:"success",summary:"\u0110\xe3 x\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng, \u0111\u01a1n h\xe0ng c\u1ee7a b\u1ea1n \u0111ang \u0111\u01b0\u1ee3c chu\u1ea9n b\u1ecb"});break;case"doneOrder":this.messageService.add({severity:"success",summary:"\u0110\u01a1n h\xe0ng \u0111\xe3 ho\xe0n th\xe0nh"});break;case"cancelOrder":this.messageService.add({severity:"warn",summary:"\u0110\u01a1n h\xe0ng \u0111\xe3 b\u1ecb h\u1ee7y"});break;case"rejectOrder":this.messageService.add({severity:"warn",summary:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y do b\u1ea1n kh\xf4ng \u0111\u1ebfn nh\u1eadn h\xe0ng"})}this.loadOrders()};this.stompClient.subscribe("/user/queue/notifications",u),this.stompClient.subscribe("/topic/public",u)},this.stompClient.onDisconnect=()=>{console.log("Disconnected!")},this.connect()}ngOnInit(){this.header=(new p.WM).set(E.ds.AUTHORIZATION,this.authService.getToken()),this.accountId=this.authService.getAccountid(),this.getUserInfo(),this.loadOrders()}ngOnDestroy(){this.disconnect()}connect(){this.stompClient.activate()}disconnect(){this.stompClient.deactivate()}loadOrders(){this.http.get(l.N.backendApiUrl+"/api/v1/project/order/findOrderByAccountId?accountId="+this.accountId,{headers:this.header}).subscribe(t=>{0===t.resultCode?(this.orders=t.data.map((n,o)=>({id:n.id,totalPrice:n.totalPrice,status:n.status,orderTime:n.orderTime})),console.log(this.orders)):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:t.message})},t=>{console.error("L\u1ed7i khi t\u1ea3i l\u1ecbch s\u1eed \u0111\u01a1n h\xe0ng:",t),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 t\u1ea3i l\u1ecbch s\u1eed \u0111\u01a1n h\xe0ng"})})}getUserInfo(){this.userInfo={fullname:this.authService.getFullname(),email:this.authService.getEmail(),phonenumber:this.authService.getPhonenumber()}}viewOrderDetails(t){console.log("\u0110ang t\u1ea3i chi ti\u1ebft \u0111\u01a1n h\xe0ng, OrderID:",t),this.http.get(l.N.backendApiUrl+"/api/v1/project/orderItem/findOrderItemByOrderId?orderId="+t,{headers:this.header}).subscribe(n=>{0===n.resultCode?n.data.length>0?(this.selectedOrderDetails=n.data.map(o=>({id:o.id,foodName:o.foodName,quantity:o.quantity,price:o.foodPrice,totalPrice:o.totalPrice,description:o.description||"Kh\xf4ng c\xf3 m\xf4 t\u1ea3",imageUrl:o.imageUrl||"default-image.jpg"})),this.showDetailModal=!0):this.messageService.add({severity:"warn",summary:"Th\xf4ng b\xe1o",detail:"Kh\xf4ng c\xf3 chi ti\u1ebft \u0111\u01a1n h\xe0ng."}):this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:n.message})},n=>{console.error("L\u1ed7i khi t\u1ea3i chi ti\u1ebft \u0111\u01a1n h\xe0ng:",n),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 t\u1ea3i chi ti\u1ebft \u0111\u01a1n h\xe0ng"})})}closeDetail(){this.showDetailModal=!1,this.selectedOrderDetails=[]}canCancelOrder(t){return"unconfirmed"===t}getOrderStatusText(t){switch(t){case"unconfirmed":return"Ch\u01b0a x\xe1c nh\u1eadn";case"done":return"\u0110\xe3 xong";case"preparing":return"\u0110ang chu\u1ea9n b\u1ecb";case"rejected":return"Kh\xe1ch h\xe0ng kh\xf4ng t\u1edbi l\u1ea5y h\xe0ng";case"cancel":return"\u0110\xe3 h\u1ee7y";default:return"Kh\xf4ng x\xe1c \u0111\u1ecbnh"}}cancelOrder(t){!confirm("B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n h\u1ee7y \u0111\u01a1n h\xe0ng n\xe0y kh\xf4ng? "+t)||(console.log(t),this.http.put(l.N.backendApiUrl+"/api/v1/project/order/cancel?orderId="+t,{},{headers:this.header}).subscribe(n=>{0===n.resultCode?this.loadOrders():this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:n.message})},n=>{console.error("L\u1ed7i khi h\u1ee7y \u0111\u01a1n h\xe0ng:",n),this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng th\u1ec3 h\u1ee7y \u0111\u01a1n h\xe0ng"})}))}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.eN),e.Y36(T.e),e.Y36(f.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-order-history"]],decls:15,vars:5,consts:[[1,"order-history-container"],["routerLink","/",1,"px-4","py-2","bg-blue-500","text-white","rounded",2,"margin-right","10px"],["routerLink","/auth/gio-hang",1,"px-4","py-2","bg-blue-500","text-white","rounded"],[1,"text-center","text-xl","font-bold","mb-4"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["emptyOrders",""],["class","modal show",4,"ngIf"],[4,"ngFor","ngForOf"],["value","Ch\u01b0a x\xe1c nh\u1eadn","severity","danger",4,"ngIf"],["value","\u0110ang chu\u1ea9n b\u1ecb",4,"ngIf"],["value","\u0110\xe3 h\u1ee7y","severity","danger",4,"ngIf"],["value","\u0110\xe3 chu\u1ea9n b\u1ecb xong","severity","success",4,"ngIf"],["value","Kh\xe1ch h\xe0ng kh\xf4ng nh\u1eadn h\xe0ng","severity","danger",4,"ngIf"],[1,"btn","btn-danger",3,"disabled","click"],[1,"btn","btn-info",3,"click"],["value","Ch\u01b0a x\xe1c nh\u1eadn","severity","danger"],["value","\u0110ang chu\u1ea9n b\u1ecb"],["value","\u0110\xe3 h\u1ee7y","severity","danger"],["value","\u0110\xe3 chu\u1ea9n b\u1ecb xong","severity","success"],["value","Kh\xe1ch h\xe0ng kh\xf4ng nh\u1eadn h\xe0ng","severity","danger"],[1,"empty-message"],[1,"modal","show"],[1,"modal-content"],["emptyDetails",""],[1,"btn","btn-danger","close-btn",3,"click"],["alt","Food Image",1,"food-img",3,"src"]],template:function(t,n){if(1&t&&(e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"button",1),e._uU(3,"Quay v\u1ec1 trang ch\u1ee7"),e.qZA(),e.TgZ(4,"button",2),e._uU(5,"Gi\u1ecf h\xe0ng"),e.qZA(),e.TgZ(6,"h2",3),e._uU(7,"L\u1ecbch s\u1eed \u0110\u01a1n H\xe0ng C\u1ee7a "),e.TgZ(8,"strong"),e._uU(9),e.qZA()(),e.YNc(10,G,13,3,"div",4),e.YNc(11,re,17,1,"table",5),e.YNc(12,oe,2,0,"ng-template",null,6,e.W1O),e.qZA(),e.YNc(14,ue,9,2,"div",7)),2&t){const o=e.MAs(13);e.xp6(9),e.hij(" ",n.userInfo.fullname," "),e.xp6(1),e.Q6J("ngIf",n.userInfo),e.xp6(1),e.Q6J("ngIf",n.orders.length>0)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",n.showDetailModal)}},dependencies:[m.sg,m.O5,d.rH,_.FN,k.V,m.JJ,m.uU],styles:['@charset "UTF-8";.order-history-container[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.empty-message[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:gray}.modal[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:white;width:60%;padding:20px;border-radius:8px;box-shadow:0 4px 6px #0003;text-align:center;position:relative;animation:fadeIn .3s ease-in-out;max-height:75vh;overflow-y:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:10px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:center}th[_ngcontent-%COMP%]{background-color:#f4f4f4}.food-img[_ngcontent-%COMP%]{width:50px;height:50px;object-fit:cover;border-radius:5px}.close-btn[_ngcontent-%COMP%]{margin-top:15px;padding:8px 16px;border:none;background:red;color:#fff;font-size:16px;cursor:pointer;border-radius:4px}.close-btn[_ngcontent-%COMP%]:hover{background:darkred}@keyframes fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}']}),r})(),ce=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[d.Bz.forChild([{path:"error",loadChildren:()=>a.e(170).then(a.bind(a,1170)).then(i=>i.ErrorModule)},{path:"access",loadChildren:()=>a.e(262).then(a.bind(a,8262)).then(i=>i.AccessModule)},{path:"dang-nhap",loadChildren:()=>a.e(50).then(a.bind(a,8050)).then(i=>i.LoginModule)},{path:"quen-mat-khau",component:q},{path:"khoi-phuc-mat-khau",component:Q},{path:"dang-ky",component:Y},{path:"kich-hoat-tai-khoan",component:O},{path:"gio-hang",component:z},{path:"lich-su",component:le}]),d.Bz]}),r})();var de=a(1208),ge=a(3860);let me=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.ez,ce,y.hJ,de.nD,b.j,g.u5,C.gz,_.EV,ge.PagesModule,k.W]}),r})()}}]);